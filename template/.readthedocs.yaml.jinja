# -*- mode: yaml; -*-
# yaml-language-server: $schema=https://raw.githubusercontent.com/readthedocs/readthedocs.org/master/readthedocs/rtd_tests/fixtures/spec/v2/schema.json
# This file is @generated by <https://github.com/liblaf/copier-python>.
# DO NOT EDIT!

# ref: <https://docs.readthedocs.com/platform/stable/config-file/v2.html>
# ref: <https://docs.readthedocs.com/platform/stable/reference/environment-variables.html>

version: 2

build:
  os: ubuntu-lts-latest
  tools:
    python: latest
  jobs:
    post_checkout:
      # ref: <https://docs.readthedocs.com/platform/stable/build-customization.html#unshallow-git-clone>
      - git fetch --unshallow || true

    # ref: <https://docs.readthedocs.com/platform/stable/build-customization.html#install-dependencies-with-uv>
    pre_create_environment:
      # {%- if package_manager == "pixi" %}
      - asdf plugin add pixi
      - asdf install pixi latest
      - asdf global pixi latest
      # {%- elif package_manager == "uv" %}
      - asdf plugin add uv
      - asdf install uv latest
      - asdf global uv latest
      # {%- endif %}

    # {%- if package_manager == "uv" %}
    create_environment:
      - uv venv "${READTHEDOCS_VIRTUALENV_PATH}"
    # {%- endif %}

    install:
      # {%- if package_manager == "pixi" %}
      - pixi install --frozen
      # {%- elif package_manager == "uv" %}
      - UV_PROJECT_ENVIRONMENT="${READTHEDOCS_VIRTUALENV_PATH}" uv sync --all-extras --all-groups --frozen --link-mode copy
      # {%- endif %}

    pre_build:
      - if test -f "docs/scripts/pre-build.sh"; then bash "docs/scripts/pre-build.sh"; fi

    # {%- if package_manager == "pixi" %}
    build:
      html:
        - pixi run mkdocs build --site-dir "$READTHEDOCS_OUTPUT/html/"
    # {%- endif %}

mkdocs:
  configuration: mkdocs.yaml
